exports.id=5452,exports.ids=[5452],exports.modules={5991:()=>{},36715:(e,r,t)=>{"use strict";t.d(r,{AF:()=>u,Gu:()=>p,Nx:()=>g,Yf:()=>d,_z:()=>f}),t(40463);var o=t(71702),s=t(34735),a=t(46677);let i=new Map,n=new Map,c=new Map,l=e=>!e.type||"connection"!==e.type,d=(e,r)=>{if(n.has(e))return;let t=process.env.NEXT_PUBLIC_API_BASE_URL||window.location.origin,s=`${t}/api/messages/sse?projectId=${e}&userId=${r}`;try{let t=new EventSource(s);t.onopen=()=>{console.log(`SSE connection opened for project: ${e}`)},t.onmessage=r=>{try{let t=JSON.parse(r.data);if(!l(t)){console.log("System message received:",t);return}let o=function(e){for(let[r,t]of c.entries())try{let o=JSON.parse(t);if(o.sender_id===e.sender_id&&o.message===e.message&&1e4>Math.abs(new Date(o.created_at).getTime()-new Date(e.created_at).getTime()))return r}catch(e){console.error("Error parsing temp message data:",e)}return null}(t),s=!!o;s&&c.delete(o),(i.get(e)||[]).forEach(e=>e(t,s))}catch(e){console.error("Error parsing message:",e)}},t.onerror=s=>{console.error("SSE connection error:",s),(0,o.oR)({title:"Connection Error",description:"Failed to connect to messaging service. Retrying...",variant:"destructive"}),t.close(),n.delete(e),setTimeout(()=>{d(e,r)},5e3)},n.set(e,t)}catch(e){console.error("Failed to create SSE connection:",e)}},g=(e,r)=>{i.has(e)||i.set(e,[]),i.get(e)?.push(r)},u=(e,r)=>{let t=i.get(e)||[],o=t.indexOf(r);-1!==o&&(t.splice(o,1),i.set(e,t))},p=e=>{let r=n.get(e);r&&(r.close(),n.delete(e),i.delete(e),console.log(`Closed SSE connection for project: ${e}`))},f=async(e,r,t,o)=>{try{let i=`temp-${Date.now()}`,n={id:i,project_id:e,sender_id:t,receiver_id:o,message:r,created_at:new Date().toISOString()};c.set(i,JSON.stringify(n));let{data:l,error:d}=await (0,s.A)("POST",a.s.PROJECT.messages(e),{message:r,receiver_id:o});if(d)throw Error(d);return{success:!0,data:l,tempId:i}}catch(e){return console.error("Error sending message:",e),{success:!1,error:e,tempId:null}}}},79921:(e,r,t)=>{"use strict";t.d(r,{b:()=>i});var o=t(26787),s=t(34735),a=t(46677);let i=(0,o.v)((e,r)=>({projects:[],isLoading:!1,error:null,stats:null,fetchProjects:async(r={})=>{try{e({isLoading:!0,error:null});let t=new URLSearchParams;Object.entries(r).forEach(([e,r])=>{r&&t.append(e,r)});let o=t.toString(),i=o?`${a.s.PROJECT.base}?${o}`:a.s.PROJECT.base,{data:n,error:c}=await (0,s.A)("GET",i);if(c)throw Error(c);return e({projects:n?.projects||[],isLoading:!1}),{data:n?.projects||[],error:null}}catch(r){return console.error("Error fetching projects:",r),e({error:r.message||"Failed to fetch projects",isLoading:!1}),{data:null,error:r.message||"Failed to fetch projects"}}},getProjectById:async r=>{try{e({isLoading:!0,error:null});let{data:t,error:o}=await (0,s.A)("GET",a.s.PROJECT.byId(r));if(o)throw Error(o);return e({isLoading:!1}),{data:t,error:null}}catch(r){return console.error("Error fetching project:",r),e({error:r.message||"Failed to fetch project",isLoading:!1}),{data:null,error:r.message||"Failed to fetch project"}}},createProject:async r=>{try{e({isLoading:!0,error:null});let{data:t,error:o}=await (0,s.A)("POST",a.s.PROJECT.base,r);if(o)throw Error(o);return e(e=>({projects:t?[t,...e.projects]:e.projects,isLoading:!1})),{data:t,error:null}}catch(r){return console.error("Error creating project:",r),e({error:r.message||"Failed to create project",isLoading:!1}),{data:null,error:r.message||"Failed to create project"}}},updateProject:async(r,t)=>{try{e({isLoading:!0,error:null});let{data:o,error:i}=await (0,s.A)("PATCH",a.s.PROJECT.byId(r),t);if(i)throw Error(i);return o?e(e=>({projects:e.projects.map(e=>e.id===r?{...e,...o}:e),isLoading:!1})):e({isLoading:!1}),{data:o,error:null}}catch(r){return console.error("Error updating project:",r),e({error:r.message||"Failed to update project",isLoading:!1}),{data:null,error:r.message||"Failed to update project"}}},deleteProject:async t=>{try{e({isLoading:!0,error:null});let o=[...r().projects];e(e=>({projects:e.projects.filter(e=>e.id!==t)}));let{error:i}=await (0,s.A)("DELETE",a.s.PROJECT.byId(t));if(i)throw e({projects:o,isLoading:!1}),Error(i);return e({isLoading:!1}),{error:null}}catch(r){return console.error("Error deleting project:",r),e({error:r.message||"Failed to delete project",isLoading:!1}),{error:r.message||"Failed to delete project"}}},fetchProjectStats:async()=>{try{e({isLoading:!0,error:null});let{data:r,error:t}=await (0,s.A)("GET",a.s.PROJECT.stats);if(t)throw Error(t);return e({stats:r,isLoading:!1}),{data:r,error:null}}catch(r){return console.error("Error fetching project statistics:",r),e({error:r.message||"Failed to fetch project statistics",isLoading:!1}),{data:null,error:r.message||"Failed to fetch project statistics"}}},fetchCustomerProjects:async(r,t={})=>{try{e({isLoading:!0,error:null});let o=new URLSearchParams;Object.entries(t).forEach(([e,r])=>{r&&o.append(e,r)});let i=o.toString(),n=i?`${a.s.PROJECT.byCustomer(r)}?${i}`:a.s.PROJECT.byCustomer(r),{data:c,error:l}=await (0,s.A)("GET",n);if(l)throw Error(l);return e({isLoading:!1}),{data:c?.projects||[],error:null}}catch(r){return console.error("Error fetching customer projects:",r),e({error:r.message||"Failed to fetch customer projects",isLoading:!1}),{data:null,error:r.message||"Failed to fetch customer projects"}}},fetchProjectFiles:async r=>{try{e({isLoading:!0,error:null});let{data:t,error:o}=await (0,s.A)("GET",a.s.PROJECT.files(r));if(o)throw Error(o);return e({isLoading:!1}),{data:t?.files||[],error:null}}catch(r){return console.error("Error fetching project files:",r),e({error:r.message||"Failed to fetch project files",isLoading:!1}),{data:null,error:r.message||"Failed to fetch project files"}}},uploadProjectFile:async(r,t)=>{try{e({isLoading:!0,error:null});let{data:o,error:i}=await (0,s.A)("POST",a.s.PROJECT.files(r),t);if(i)throw Error(i);return e({isLoading:!1}),{data:o,error:null}}catch(r){return console.error("Error uploading file:",r),e({error:r.message||"Failed to upload file",isLoading:!1}),{data:null,error:r.message||"Failed to upload file"}}},deleteProjectFile:async(r,t)=>{try{e({isLoading:!0,error:null});let{error:o}=await (0,s.A)("DELETE",`${a.s.PROJECT.files(r)}/${t}`);if(o)throw Error(o);return e({isLoading:!1}),{error:null}}catch(r){return console.error("Error deleting file:",r),e({error:r.message||"Failed to delete file",isLoading:!1}),{error:r.message||"Failed to delete file"}}},fetchProjectFeedback:async r=>{try{e({isLoading:!0,error:null});let{data:t,error:o}=await (0,s.A)("GET",a.s.PROJECT.feedback(r));if(o)throw Error(o);return e({isLoading:!1}),{data:t?.feedback||[],error:null}}catch(r){return console.error("Error fetching project feedback:",r),e({error:r.message||"Failed to fetch project feedback",isLoading:!1}),{data:null,error:r.message||"Failed to fetch project feedback"}}},addProjectFeedback:async(r,t)=>{try{e({isLoading:!0,error:null});let{data:o,error:i}=await (0,s.A)("POST",a.s.PROJECT.feedback(r),t);if(i)throw Error(i);return e({isLoading:!1}),{data:o,error:null}}catch(r){return console.error("Error adding feedback:",r),e({error:r.message||"Failed to add feedback",isLoading:!1}),{data:null,error:r.message||"Failed to add feedback"}}},updateFeedbackStatus:async(r,t,o)=>{try{e({isLoading:!0,error:null});let{data:i,error:n}=await (0,s.A)("PATCH",`${a.s.PROJECT.feedback(r)}/${t}`,{status:o});if(n)throw Error(n);return e({isLoading:!1}),{data:i,error:null}}catch(r){return console.error("Error updating feedback status:",r),e({error:r.message||"Failed to update feedback status",isLoading:!1}),{data:null,error:r.message||"Failed to update feedback status"}}},fetchProjectMessages:async r=>{try{e({isLoading:!0,error:null});let{data:t,error:o}=await (0,s.A)("GET",a.s.PROJECT.messages(r));if(o)throw Error(o);return e({isLoading:!1}),{data:t?.messages||[],error:null}}catch(r){return console.error("Error fetching project messages:",r),e({error:r.message||"Failed to fetch project messages",isLoading:!1}),{data:null,error:r.message||"Failed to fetch project messages"}}},sendProjectMessage:async(r,t)=>{try{e({isLoading:!0,error:null});let{data:o,error:i}=await (0,s.A)("POST",a.s.PROJECT.messages(r),t);if(i)throw Error(i);return e({isLoading:!1}),{data:o,error:null}}catch(r){return console.error("Error sending message:",r),e({error:r.message||"Failed to send message",isLoading:!1}),{data:null,error:r.message||"Failed to send message"}}},clearProjects:()=>e({projects:[]}),clearError:()=>e({error:null})}))},80702:()=>{}};